/* Event Closed - Form STICKY2\O_CONFIG */
CHAR aTextValue[255]="text";
LONG anIntegerValue=0;
ULONG anUnsignedValue=0;


MsgLog("Closing O_CONFIG");

if (c_mini)
{
SWP swp;
anUnsignedValue=(ULONG)WinQueryButtonCheckstate(hwndDlg,MINI_CONFIG);
  
  strcpy(gStickyIcon, anUnsignedValue ? gYes : gNo);  
  PutString(S_StickyIcon, gStickyIcon); 
  WinQueryWindowPos(gHwndFrame, &swp);
  if (swp.fl & SWP_RESTORE)
     {
     MsgLog("O_CONFIG - RESTORE");
     WinPostMsg(gHwndFrame, WM_USER_RESTORE, 0, 0);
     }
 

} /* end if */

if (c_cas)
{
anUnsignedValue=(ULONG)WinQueryButtonCheckstate(hwndDlg,SEND_CONFIG);

  strcpy(gAfterSend, anUnsignedValue ? gYes : gNo);  
  PutString(S_CloseAfterSend, gAfterSend); 
} /* end if */
if (c_car)
{
anUnsignedValue=(ULONG)WinQueryButtonCheckstate(hwndDlg,REPLY_CONFIG);
  strcpy(gAfterReply, anUnsignedValue ? gYes: gNo );  
  PutString(S_CloseAfterReply, gAfterReply); 

} /* end if */
if (c_pop)
{
anUnsignedValue=(ULONG)WinQueryButtonCheckstate(hwndDlg,BACKGROUND_CONFIG);
  strcpy(gPUS, anUnsignedValue ? gYes: gNo );  
  PutString(S_PopUpSticky, gPUS); 

    
} /* end if */
if (c_aus)
{
anUnsignedValue=(ULONG)WinQueryButtonCheckstate(hwndDlg,SURE_CONFIG);
  
   strcpy(gSure, anUnsignedValue ? gYes : gNo );
   PutString(S_AreYouSure, gSure ); 

  
} /* end if */
if (c_beep)
{
anUnsignedValue=(ULONG)WinQueryButtonCheckstate(hwndDlg,BEEP_CONFIG);
  
  PutString(S_Beep, anUnsignedValue ? gYes: gNo ); 
  strcpy(gBeep, anUnsignedValue ? gYes : gNo);
  
} /* end if */
/* Get item value (numeric style) FREQUENCY_CONFIG Spin Button */
WinSendDlgItemMsg(hwndDlg, FREQUENCY_CONFIG,
                  SPBM_QUERYVALUE,
                  MPFROMP(&anUnsignedValue),   /* Buffer for value */
                  MPFROM2SHORT(0,SPBQ_ALWAYSUPDATE));
if (atol(gFreq) != anUnsignedValue)
{
  sprintf(gFreq, "%d", anUnsignedValue);
  PutString(S_Frequency, gFreq);
} /* end if */
                  

/* Get item value (numeric style) DURATION_CONFIG Spin Button */
WinSendDlgItemMsg(hwndDlg, DURATION_CONFIG,
                  SPBM_QUERYVALUE,
                  MPFROMP(&anUnsignedValue),   /* Buffer for value */
                  MPFROM2SHORT(0,SPBQ_ALWAYSUPDATE));
if (atol(gDur) != anUnsignedValue)
{
  sprintf(gDur, "%d", anUnsignedValue);
  PutString(S_Duration, gDur);
} /* end if */

/* Get item value (numeric style) DURATION_CONFIG Spin Button */
WinSendDlgItemMsg(hwndDlg, CLEAR_CONFIG,
                  SPBM_QUERYVALUE,
                  MPFROMP(&anUnsignedValue),   /* Buffer for value */
                  MPFROM2SHORT(0,SPBQ_ALWAYSUPDATE));
if (atol(gClearAuto) != anUnsignedValue)
{
  sprintf(gClearAuto, "%d", anUnsignedValue);
  PutString(S_ClearAuto, gClearAuto);
} /* end if */

